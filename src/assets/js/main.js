function hasClass(e,t){return(" "+e.className+" ").indexOf(" "+t+" ")>-1}function addRemoveClass(e,t){hasClass(e,t)?e.classList.remove(t):e.classList.add(t)}function loader(e){var t=document.getElementById(e);addRemoveClass(t,"loader")}function siblingsAddRemoveClass(e,t){for(var a=e.parentNode.childNodes,n=0;n<a.length;n++)1==a[n].nodeType&&a[n].classList.remove(t);e.classList.add(t)}function mainMenu(e){return addRemoveClass(e,"opened"),!1}function capitalizeFirstLetter(e){return e.charAt(0).toUpperCase()+e.slice(1)}function append(e,t){var a=document.getElementById(t);if(a.childNodes.length>0){for(var n=[],o=0;o<a.childNodes.length;o++)1==a.childNodes[o].nodeType&&n.push(a.childNodes[o]);n[0].appendChild(e)}else a.appendChild(e)}function supports_html5_storage(){try{return"localStorage"in window&&null!==window.localStorage}catch(e){return!1}}function changeFile(e){var t=e.files,a=t.length;if(a){var n=document.getElementById("checked");n&&n.parentNode.removeChild(n);var o=document.createElement("div");o.id="checked",o.className="inline-block green margin10",o.innerHTML='<i class="material-icons">check</i>',document.getElementById("filediv").appendChild(o)}else{var d=document.getElementById("checked");d.parentElement.removeChild(d)}}function formValidate(e){e.preventDefault();var t,a=addform.elements.category.value,n=addform.elements.photoname.value,o=addform.elements.description.value,d=addform.elements.file.files[0];if(""==a||""==n)alert("Fill in required fields");else{if(loader("addform"),localStorage.length)for(var l=0;l<localStorage.length;l++){var r=localStorage.key(l),i=JSON.parse(localStorage.getItem(r));if(i.name===n)return alert("this photo allready exists!"),loader("addform"),!1}if(t={cat:a,name:n,desc:o},document.getElementById("file").value.length){if(!d.name.match(/\.(jpg|jpeg|png|gif)$/))return alert("please choose a image file"),loader("addform"),!1;createImg(t,app.addPhoto,app.addToStorage)}else t.img=document.getElementById("videoImage").src,app.changeView("gallery",null,function(){app.addPhoto(t),app.addToStorage(t)})}}function clearForm(){addform.elements.category.value="",addform.elements.photoname.value="",addform.elements.description.value="",addform.elements.file.value="";var e=document.getElementById("checked");e.parentNode.removeChild(e)}function createImg(e,t,a){var n,o,d,l;return"function"!=typeof window.FileReader?void write("The file API isn't supported on this browser yet."):(n=document.getElementById("file"),void(n?n.files?n.files[0]?(o=n.files[0],d=new FileReader,d.onload=function(){l=new Image,l.onload=function(){var n=document.getElementById("canvas");n.width=l.width,n.height=l.height;var o=n.getContext("2d");o.drawImage(l,0,0),e.img=n.toDataURL("image/png"),app.changeView("gallery",null,function(){t(e),a(e)})},l.src=d.result},d.readAsDataURL(o)):(alert("Please select a file before clicking 'Submit'"),loader("addform")):(alert("This browser doesn't seem to support the `files` property of file inputs."),loader("addform")):(alert("Um, couldn't find the imgfile element."),loader("addform"))))}function checkIfEmpty(e,t){var a=document.querySelector(e);return a.children.length<1?t?void t():!0:!1}function cleardiv(e){var t=document.querySelector(e);t.innerHTML=""}function videoStart(e){e.preventDefault();var t=document.getElementById("fader");addRemoveClass(t,"active");var a=document.getElementById("addToForm");a.style.display="none";var n=document.getElementById("takephoto");if(n.setAttribute("onclick","takePhoto(this, event)"),n.innerHTML='take a photo <i class="material-icons">photo_camera</i>',videoRun(e),document.getElementById("camera").children.length>1){var o=document.getElementById("camera").children[1];o.parentNode.removeChild(o)}}function videoRun(e,t){if(e.preventDefault(),navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia,navigator.getUserMedia?navigator.getUserMedia({audio:!1,video:{width:640,height:480}},function(e){var t=document.querySelector("video"),a=document.getElementById("videoImage");a.style.display="none",t.src=window.URL.createObjectURL(e),t.style.display="block",t.onloadedmetadata=function(e){t.play()},mediaStream=e},function(e){alert("The following error occurred: "+e.name)}):alert("getUserMedia not supported"),t){t.innerHTML='take a photo <i class="material-icons">photo_camera</i>',t.setAttribute("onclick","takePhoto(this, event)");var a=document.getElementById("addToForm");a.style.display="none"}}function videoStop(e){e.preventDefault();var t=document.querySelector("video"),a=document.getElementById("fader"),n=document.getElementById("addToForm");addRemoveClass(a,"active"),mediaStream.getVideoTracks()[0].stop(),t.src="",t.style.display="none",n.style.display="none"}function takePhoto(e,t){t.preventDefault();var a=document.querySelector("video"),n=document.getElementById("canvas2"),o=document.getElementById("videoImage"),d=document.getElementById("addToForm");n.getContext("2d").drawImage(a,0,0,640,480),o.src=n.toDataURL("image/png"),o.style.display="block",mediaStream.getVideoTracks()[0].stop(),a.src="",a.style.display="none",d.style.display="inline-block",e.innerHTML='take another<i class="material-icons">videocam</i>',e.setAttribute("onclick","videoRun(event, this)")}function addToForm(e){e.preventDefault();var t=document.getElementById("fader");addRemoveClass(t,"active"),document.getElementById("file").value="";var a=document.getElementById("checked");a&&a.parentNode.removeChild(a);var n=document.createElement("div");n.id="checked",n.className="inline-block green",n.innerHTML='<i class="material-icons">check</i>',document.getElementById("camera").appendChild(n)}supports_html5_storage()||alert("You can't use localstorage, please allow it or use another browser!");var viewlinks=document.querySelectorAll("#nav ul li a"),viewlinksItems=[].slice.call(viewlinks);viewlinksItems.forEach(function(e,t){var a=e.getAttribute("href");e.addEventListener("click",function(e){e.preventDefault(),app.changeView(a)})});var mediaStream=null;
